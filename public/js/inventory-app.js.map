{"version":3,"sources":["item-movement.js","item-list.js","dashboard.js","item_show.js","utils.js","bootstrap3-typeahead.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"inventory-app.js","sourcesContent":["$(\"#item_movement\").length > 0 ? new Vue({\r\n    el: \"#item_movement\",\r\n    ready: function(){\r\n        console.log(this.item_id);\r\n        this.fetchItem();\r\n        this.fetchLastMovements();\r\n\r\n    },\r\n\r\n    data: {\r\n        item: {name: \"Loading..\"},\r\n        item_id: \"\",\r\n        direction: \"\",\r\n        movements: [],\r\n        new_movement: {\r\n            description: \"\",\r\n            reference: \"\",\r\n            quantity: \"\"\r\n        },\r\n        saving: false,\r\n    },\r\n    methods: {\r\n        fetchItem: function(){\r\n            this.$http.get(\"/api/v1/items/\" + this.item_id, function(response){\r\n                this.item = response.item;\r\n            });\r\n        },\r\n        fetchLastMovements: function(){\r\n            this.$http.get(\"/api/v1/items/\"+ this.item_id + \"/movements?max=5\", function(response){\r\n                this.movements = response.movements;\r\n            });\r\n        },\r\n        saveNewMovement: function(e){\r\n            this.saving = true;\r\n            e.preventDefault();\r\n            this.new_movement.quantity *= this.direction;\r\n            this.$http.post(\"/api/v1/items/\" + this.item_id + \"/movements/\", this.new_movement, function(response){\r\n                this.saving = false;\r\n                this.movements.push(response.movement);\r\n                this.item = response.item;\r\n\r\n                this.item.quantity +=this.new_movement.quantity;\r\n                    this.new_movement.description = \"\";\r\n                this.new_movement.reference = \"\";\r\n                this.new_movement.quantity = \"\";\r\n            }).error(function(d,s,r){\r\n                // re-enable saving and call generic handler.\r\n                this.saving = false;\r\n                window.httpErrorHandler(d,s,r);\r\n            });\r\n        }\r\n    }\r\n}) : null;","\r\n// todo: Adding a blank item this way is silly.\r\n$(\"#list-items\").length > 0 ? new Vue({\r\n    el: \"#list-items\",\r\n\r\n    data: {\r\n        items: [],\r\n        new_item: {item_name: \"\", client: {},\r\n            created_at: new moment()},\r\n        deleteConfirm: false,\r\n        from: 0,\r\n        to: 0,\r\n        total: 0,\r\n        current_page: 0,\r\n        last_page: 0,\r\n        filtered_to_client_id: \"\",\r\n        client_filter_input_text: '',\r\n        sortKey: 'item_name',\r\n        reverse: false,\r\n        columns: [\r\n            {id:'item_name', name:\"Name\", click: function(a,b,c){\r\n                debugger;\r\n                this.redirectToURL('/items/' + item.id);\r\n            } },\r\n            {id:'client_name', name:\"Client\" },\r\n            {id:'item_code', name:\"Code\" },\r\n            {id:'quantity', name:\"Quantity\" },\r\n            {id:'minimum_level', name:\"Minimum Level\" },\r\n            {id:'created_at', name:\"Created\" }]\r\n    },\r\n\r\n    ready: function(){\r\n        this.fetchItems();\r\n        this.clientNameTypeahead();\r\n    },\r\n\r\n    methods: {\r\n        sortBy: function(sortKey){\r\n            var column = null;\r\n            for(var i = 0; i < this.columns.length; i++){\r\n                if(this.columns[i].name == sortKey){\r\n                    column = this.columns[i];\r\n                    break;\r\n                }\r\n            }\r\n            this.reverse = (this.sortKey == sortKey) ? !this.reverse : false;\r\n            this.sortKey = sortKey;\r\n        },\r\n        fetchItems: function(page){\r\n            var url = 'api/v1/items?page=' + page;\r\n            if(this.filtered_to_client_id){\r\n                url += \"&clientId=\" + this.filtered_to_client_id;\r\n            }\r\n            this.$http.get(url, function(response){\r\n                this.from = response.from;\r\n                this.to = response.to;\r\n                this.total = response.total;\r\n                this.current_page = response.current_page;\r\n                this.last_page = response.last_page;\r\n                this.items = [];\r\n                for(var i = 0; i < response.data.length; i++){\r\n                    var row = response.data[i];\r\n                    row.client_id = row.client.id;\r\n                    row.client_name = row.client.name;\r\n\r\n                this.items.push(row);\r\n\r\n                }\r\n            })\r\n        },\r\n\r\n        saveNewItem: function(){\r\n\r\n           /* if(this.new_item.item_name == \"\"){\r\n                addAlert(\"Please add an item name.\", \"danger\");\r\n                return;\r\n            }*/\r\n\r\n            this.$http.post('api/v1/items', this.new_item, function(d){\r\n                d.item.client_id = d.item.client.id;\r\n                d.item.client_name = d.item.client.name;\r\n                this.items.push(d.item);\r\n                this.new_item = {item_name: \"\",\r\n                    created_at: new moment().format()};\r\n            }).error(httpErrorHandler);\r\n        },\r\n        redirectToURL: function(url){\r\n            document.location = url;\r\n        },\r\n        clientNameTypeahead: function(){\r\n\r\n            $.get('/api/v1/clients', function(data){\r\n                var ta =$(\"#client-name-typeahead\");\r\n                ta.typeahead({\r\n                    source:data.clients,\r\n                });\r\n\r\n                var ta = $(\"#client-filter-typeahead\");\r\n                ta.typeahead({\r\n                    source:data.clients,\r\n                });\r\n\r\n            },'json');\r\n        },\r\n        getSelectedClient: function(){\r\n            var ta =$(\"#client-name-typeahead\");\r\n            var current = ta.typeahead(\"getActive\");\r\n\r\n            if(current.id){\r\n                this.new_item.client_id = current.id;\r\n                this.new_item.client = current;\r\n\r\n            }\r\n        },\r\n        filterToSelectedClient: function(){\r\n            var ta =$(\"#client-filter-typeahead\");\r\n            var current = ta.typeahead(\"getActive\");\r\n\r\n            if(current.id){\r\n                this.filtered_to_client_id = current.id;\r\n                this.fetchItems(0);\r\n\r\n            }\r\n        },\r\n        removeFilterToSelectedClient: function(e){\r\n            this.filtered_to_client_id = \"\";\r\n            this.client_filter_input_text = \"\";\r\n            this.fetchItems(0);\r\n        },\r\n\r\n        deleteAreYouSure: function(e){\r\n            this.deleteConfirm = true;\r\n\r\n            e.stopPropagation();\r\n        },\r\n\r\n        deleteItem: function(item, e){\r\n\r\n            var i = item;\r\n            this.items.$remove(i);\r\n            this.$http.delete('api/v1/items/' + item.id, {}, function(d){\r\n\r\n                addAlert('Item Deleted', 'success');\r\n            });\r\n        }\r\n    }\r\n\r\n}) :  null;","\r\n$(\"#dashboard\").length > 0 ? new Vue({\r\n    el: '#dashboard',\r\n\r\n    ready: function(){\r\n        this.fetchDashboard();\r\n        this.fetchTypeaheadItems();\r\n    },\r\n\r\n    data: {\r\n        expectedDeliveries: [\r\n            {\r\n                id: 10,\r\n                item_name: \"Bottle Caps\",\r\n                expected_at: \"2015-11-04 11:00:00 +1100\"\r\n            },\r\n            {\r\n                id: 11,\r\n                item_name: \"Bottle Caps\",\r\n                expected_at: \"2015-11-04 11:00:00 +1100\"\r\n            },\r\n        ],\r\n        itemsBelowMinimum: [\r\n            {\r\n                id: 10,\r\n                item_name: \"Bottle Caps\",\r\n                expected_at: \"2015-11-04 11:00:00 +1100\",\r\n                quantity: 500,\r\n            },\r\n            {\r\n                id: 11,\r\n                item_name: \"Bottle Caps\",\r\n                expected_at: \"2015-11-04 11:00:00 +1100\",\r\n                quantity: 400,\r\n            },\r\n        ],\r\n        feed: [\r\n            {\r\n                quantity: 1000,\r\n                item_name: \"Bottle Caps\",\r\n                created_at_human: \"10m ago\",\r\n                item: {item_name: \"\"}\r\n            },\r\n            {\r\n                quantity: -5,\r\n                item_name: \"Bottle Caps\",\r\n                created_at_human: \"20m ago\",\r\n                item: {item_name: \"\"}\r\n            },\r\n            {\r\n                quantity: -7,\r\n                item_name: \"Bottle Caps\",\r\n                created_at_human: \"24m ago\",\r\n                item: {item_name: \"\"}\r\n            },\r\n        ],\r\n        showExpectedDeliveries: false,\r\n        showItemsBelowMinimum: false,\r\n        selectedItem: \"\",\r\n    },\r\n    methods: {\r\n        fetchDashboard: function(){\r\n            this.$http.get('api/v1/dashboard', function(response){\r\n                for(var key in response.data){\r\n                    this[key] = response.data[key];\r\n                }\r\n                // this.items = response.items;\r\n            });\r\n        },\r\n\r\n        fetchTypeaheadItems: function(){\r\n            $.get('/api/v1/items/?perPage=10000', function(response){\r\n                var ta =$(\"#item-name-typeahead\");\r\n                for(var i = 0; i <response.data.length; i++){\r\n                    response.data[i].name = response.data[i].item_name;\r\n                }\r\n                ta.typeahead({\r\n                    source:response.data,\r\n                });\r\n            },'json');\r\n        },\r\n\r\n        getSelectedItem: function(){\r\n\r\n            var ta =$(\"#item-name-typeahead\");\r\n            var current = ta.typeahead(\"getActive\");\r\n\r\n            if(current.id){\r\n                this.selectedItem = current;\r\n\r\n            }\r\n        },\r\n\r\n        clearSelectedItem: function(){\r\n            this.selectedItem = \"\";\r\n            $(\"#item-name-typeahead\").val(\"\").focus();\r\n        },\r\n\r\n        redirectToURL: function(url){\r\n            document.location = url;\r\n        }\r\n    }\r\n}) :  null;\r\n\r\n","    google.load('visualization', '1', {packages: ['corechart', 'line']});\r\n\r\n\r\n$(\"#item_show\").length > 0 ? new Vue({\r\n    el: \"#item_show\",\r\n    ready: function(){\r\n        console.log(this.item_id);\r\n        this.fetchItem();\r\n        this.fetchLastMovements();\r\n\r\n    },\r\n\r\n    data: {\r\n        item: {name: \"Loading..\"},\r\n        item_id: \"\",\r\n        direction: \"\",\r\n        movements: [],\r\n        new_movement: {\r\n            description: \"\",\r\n            reference: \"\",\r\n            quantity: \"\"\r\n        },\r\n        saving: false,\r\n    },\r\n    methods: {\r\n        fetchItem: function(){\r\n            this.$http.get(\"/api/v1/items/\" + this.item_id, function(response){\r\n                this.item = response.item;\r\n            });\r\n        },\r\n        fetchLastMovements: function(){\r\n            this.$http.get(\"/api/v1/items/\"+ this.item_id + \"/movements?max=50\", function(response){\r\n                this.movements = response.movements;\r\n                this.loadChart(response.movements);\r\n\r\n\r\n\r\n            });\r\n        },\r\n        loadChart: function(movement_data){\r\n                var data = new google.visualization.DataTable();\r\n                data.addColumn('date', 'X');\r\n                data.addColumn('number', 'In Store');\r\n\r\n                var options = {\r\n                    hAxis: {\r\n                        title: 'Date'\r\n                    },\r\n                    vAxis: {\r\n                        title: 'In Store'\r\n                    }\r\n                };\r\n\r\n                var chart_data = [];\r\n                for(var i = 0; i < movement_data.length; i++){\r\n                    var row = [new moment(movement_data[i].created_at).toDate(), movement_data[i].result_quantity];\r\n                    chart_data.push(row);\r\n                }\r\n            data.addRows(chart_data);\r\n\r\n                var chart = new google.visualization.LineChart(document.getElementById('chart_div'));\r\n                chart.draw(data, options);\r\n\r\n\r\n        },\r\n        saveNewMovement: function(e){\r\n            this.saving = true;\r\n            e.preventDefault();\r\n            var toSend = this.new_movement;\r\n            this.new_movement.quantity *= this.direction;\r\n            debugger;\r\n            this.$http.post(\"/api/v1/items/\" + this.item_id + \"/movements/\", this.new_movement, function(response){\r\n                this.saving = false;\r\n                this.movements.push(response.movement);\r\n                this.item = response.item;\r\n\r\n                this.new_movement.description = \"\";\r\n                this.new_movement.reference = \"\";\r\n                this.new_movement.quantity = \"\";\r\n            });\r\n        }\r\n    }\r\n}) : null;","\r\nvar addAlert = function(message, type, delay){\r\n    if(typeof delay == \"undefined\"){\r\n        delay = 1000;\r\n    }\r\n\r\n    var alert = $(\"#alert-template\").html();\r\n    alert = alert.replace(\"{alert-type}\", type);\r\n    alert = alert.replace(\"{alert-message}\", message);\r\n\r\n    var $alert = $(alert);\r\n    $(\".overlay-alert\").append($alert);\r\n\r\n    if(delay > -1){\r\n        window.setTimeout(function(){\r\n            $alert.fadeOut(1000, function(){$alert.remove()});\r\n        },delay);\r\n    }\r\n\r\n};\r\n\r\nwindow.httpErrorHandler = function(d,s,r){\r\n    if(!d && !s && !r) return;\r\n    if(s == 422){\r\n        // validation error.\r\n        var errors = [];\r\n        for(var failed_field in d){\r\n            for(var i = 0; i < d[failed_field].length; i++){\r\n                errors.push(d[failed_field][i]);\r\n            }\r\n        }\r\n\r\n        if(errors.length > 0){\r\n            addAlert(\"There were errors! Your change has not been saved:<br/><br/>\" + errors.join(\"<br/>\"), \"danger\", 5000);\r\n        }\r\n    }\r\n    else{\r\n        addAlert(\"HTTP error code \" + s + \" was thrown.\", -1);\r\n        debugger;\r\n    }\r\n}\r\n\r\n\r\nvar abc = function(){\r\n}\r\n","/* =============================================================\n * bootstrap3-typeahead.js v3.1.0\n * https://github.com/bassjobsen/Bootstrap-3-Typeahead\n * =============================================================\n * Original written by @mdo and @fat\n * =============================================================\n * Copyright 2014 Bass Jobsen @bassjobsen\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * ============================================================ */\n\n\n(function (root, factory) {\n\n  'use strict';\n\n  // CommonJS module is defined\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = factory(require('jquery'));\n  }\n  // AMD module is defined\n  else if (typeof define === 'function' && define.amd) {\n    define(['jquery'], function ($) {\n      return factory ($);\n    });\n  } else {\n    factory(root.jQuery);\n  }\n\n}(this, function ($) {\n\n  'use strict';\n  // jshint laxcomma: true\n\n\n /* TYPEAHEAD PUBLIC CLASS DEFINITION\n  * ================================= */\n\n  var Typeahead = function (element, options) {\n    this.$element = $(element);\n    this.options = $.extend({}, $.fn.typeahead.defaults, options);\n    this.matcher = this.options.matcher || this.matcher;\n    this.sorter = this.options.sorter || this.sorter;\n    this.select = this.options.select || this.select;\n    this.autoSelect = typeof this.options.autoSelect == 'boolean' ? this.options.autoSelect : true;\n    this.highlighter = this.options.highlighter || this.highlighter;\n    this.render = this.options.render || this.render;\n    this.updater = this.options.updater || this.updater;\n    this.displayText = this.options.displayText || this.displayText;\n    this.source = this.options.source;\n    this.delay = this.options.delay;\n    this.$menu = $(this.options.menu);\n    this.$appendTo = this.options.appendTo ? $(this.options.appendTo) : null;\n    this.shown = false;\n    this.listen();\n    this.showHintOnFocus = typeof this.options.showHintOnFocus == 'boolean' ? this.options.showHintOnFocus : false;\n    this.afterSelect = this.options.afterSelect;\n    this.addItem = false;\n  };\n\n  Typeahead.prototype = {\n\n    constructor: Typeahead,\n\n    select: function () {\n      var val = this.$menu.find('.active').data('value');\n      this.$element.data('active', val);\n      if(this.autoSelect || val) {\n        var newVal = this.updater(val);\n        this.$element\n          .val(this.displayText(newVal) || newVal)\n          .change();\n        this.afterSelect(newVal);\n      }\n      return this.hide();\n    },\n\n    updater: function (item) {\n      return item;\n    },\n\n    setSource: function (source) {\n      this.source = source;\n    },\n\n    show: function () {\n      var pos = $.extend({}, this.$element.position(), {\n        height: this.$element[0].offsetHeight\n      }), scrollHeight;\n\n      scrollHeight = typeof this.options.scrollHeight == 'function' ?\n          this.options.scrollHeight.call() :\n          this.options.scrollHeight;\n\n      (this.$appendTo ? this.$menu.appendTo(this.$appendTo) : this.$menu.insertAfter(this.$element))\n        .css({\n          top: pos.top + pos.height + scrollHeight\n        , left: pos.left\n        })\n        .show();\n\n      this.shown = true;\n      return this;\n    },\n\n    hide: function () {\n      this.$menu.hide();\n      this.shown = false;\n      return this;\n    },\n\n    lookup: function (query) {\n      var items;\n      if (typeof(query) != 'undefined' && query !== null) {\n        this.query = query;\n      } else {\n        this.query = this.$element.val() ||  '';\n      }\n\n      if (this.query.length < this.options.minLength) {\n        return this.shown ? this.hide() : this;\n      }\n\n      var worker = $.proxy(function() {\n\n        if($.isFunction(this.source)) this.source(this.query, $.proxy(this.process, this));\n        else if (this.source) {\n          this.process(this.source);\n        }\n      }, this);\n\n      clearTimeout(this.lookupWorker);\n      this.lookupWorker = setTimeout(worker, this.delay);\n    },\n\n    process: function (items) {\n      var that = this;\n\n      items = $.grep(items, function (item) {\n        return that.matcher(item);\n      });\n\n      items = this.sorter(items);\n\n      if (!items.length && !this.options.addItem) {\n        return this.shown ? this.hide() : this;\n      }\n\n      if (items.length > 0) {\n        this.$element.data('active', items[0]);\n      } else {\n        this.$element.data('active', null);\n      }\n\n      // Add item\n      if (this.options.addItem){\n        items.push(this.options.addItem);\n      }\n\n      if (this.options.items == 'all') {\n        return this.render(items).show();\n      } else {\n        return this.render(items.slice(0, this.options.items)).show();\n      }\n    },\n\n    matcher: function (item) {\n    var it = this.displayText(item);\n      return ~it.toLowerCase().indexOf(this.query.toLowerCase());\n    },\n\n    sorter: function (items) {\n      var beginswith = []\n        , caseSensitive = []\n        , caseInsensitive = []\n        , item;\n\n      while ((item = items.shift())) {\n        var it = this.displayText(item);\n        if (!it.toLowerCase().indexOf(this.query.toLowerCase())) beginswith.push(item);\n        else if (~it.indexOf(this.query)) caseSensitive.push(item);\n        else caseInsensitive.push(item);\n      }\n\n      return beginswith.concat(caseSensitive, caseInsensitive);\n    },\n\n    highlighter: function (item) {\n          var html = $('<div></div>');\n          var query = this.query;\n          var i = item.toLowerCase().indexOf(query.toLowerCase());\n          var len, leftPart, middlePart, rightPart, strong;\n          len = query.length;\n          if(len === 0){\n              return html.text(item).html();\n          }\n          while (i > -1) {\n              leftPart = item.substr(0, i);\n              middlePart = item.substr(i, len);\n              rightPart = item.substr(i + len);\n              strong = $('<strong></strong>').text(middlePart);\n              html\n                  .append(document.createTextNode(leftPart))\n                  .append(strong);\n              item = rightPart;\n              i = item.toLowerCase().indexOf(query.toLowerCase());\n          }\n          return html.append(document.createTextNode(item)).html();\n    },\n\n    render: function (items) {\n      var that = this;\n      var self = this;\n      var activeFound = false;\n      items = $(items).map(function (i, item) {\n        var text = self.displayText(item);\n        i = $(that.options.item).data('value', item);\n        i.find('a').html(that.highlighter(text));\n        if (text == self.$element.val()) {\n            i.addClass('active');\n            self.$element.data('active', item);\n            activeFound = true;\n        }\n        return i[0];\n      });\n\n      if (this.autoSelect && !activeFound) {\n        items.first().addClass('active');\n        this.$element.data('active', items.first().data('value'));\n      }\n      this.$menu.html(items);\n      return this;\n    },\n\n    displayText: function(item) {\n      return item.name || item;\n    },\n\n    next: function (event) {\n      var active = this.$menu.find('.active').removeClass('active')\n        , next = active.next();\n\n      if (!next.length) {\n        next = $(this.$menu.find('li')[0]);\n      }\n\n      next.addClass('active');\n    },\n\n    prev: function (event) {\n      var active = this.$menu.find('.active').removeClass('active')\n        , prev = active.prev();\n\n      if (!prev.length) {\n        prev = this.$menu.find('li').last();\n      }\n\n      prev.addClass('active');\n    },\n\n    listen: function () {\n      this.$element\n        .on('focus',    $.proxy(this.focus, this))\n        .on('blur',     $.proxy(this.blur, this))\n        .on('keypress', $.proxy(this.keypress, this))\n        .on('keyup',    $.proxy(this.keyup, this));\n\n      if (this.eventSupported('keydown')) {\n        this.$element.on('keydown', $.proxy(this.keydown, this));\n      }\n\n      this.$menu\n        .on('click', $.proxy(this.click, this))\n        .on('mouseenter', 'li', $.proxy(this.mouseenter, this))\n        .on('mouseleave', 'li', $.proxy(this.mouseleave, this));\n    },\n\n    destroy : function () {\n      this.$element.data('typeahead',null);\n      this.$element.data('active',null);\n      this.$element\n        .off('focus')\n        .off('blur')\n        .off('keypress')\n        .off('keyup');\n\n      if (this.eventSupported('keydown')) {\n        this.$element.off('keydown');\n      }\n\n      this.$menu.remove();\n    },\n\n    eventSupported: function(eventName) {\n      var isSupported = eventName in this.$element;\n      if (!isSupported) {\n        this.$element.setAttribute(eventName, 'return;');\n        isSupported = typeof this.$element[eventName] === 'function';\n      }\n      return isSupported;\n    },\n\n    move: function (e) {\n      if (!this.shown) return;\n\n      switch(e.keyCode) {\n        case 9: // tab\n        case 13: // enter\n        case 27: // escape\n          e.preventDefault();\n          break;\n\n        case 38: // up arrow\n          // with the shiftKey (this is actually the left parenthesis)\n          if (e.shiftKey) return;\n          e.preventDefault();\n          this.prev();\n          break;\n\n        case 40: // down arrow\n          // with the shiftKey (this is actually the right parenthesis)\n          if (e.shiftKey) return;\n          e.preventDefault();\n          this.next();\n          break;\n      }\n    },\n\n    keydown: function (e) {\n      this.suppressKeyPressRepeat = ~$.inArray(e.keyCode, [40,38,9,13,27]);\n      if (!this.shown && e.keyCode == 40) {\n        this.lookup();\n      } else {\n        this.move(e);\n      }\n    },\n\n    keypress: function (e) {\n      if (this.suppressKeyPressRepeat) return;\n      this.move(e);\n    },\n\n    keyup: function (e) {\n      switch(e.keyCode) {\n        case 40: // down arrow\n        case 38: // up arrow\n        case 16: // shift\n        case 17: // ctrl\n        case 18: // alt\n          break;\n\n        case 9: // tab\n        case 13: // enter\n          if (!this.shown) return;\n          this.select();\n          break;\n\n        case 27: // escape\n          if (!this.shown) return;\n          this.hide();\n          break;\n        default:\n          this.lookup();\n      }\n\n      e.preventDefault();\n   },\n\n   focus: function (e) {\n      if (!this.focused) {\n        this.focused = true;\n        if (this.options.showHintOnFocus) {\n          this.lookup('');\n        }\n      }\n    },\n\n    blur: function (e) {\n      this.focused = false;\n      if (!this.mousedover && this.shown) this.hide();\n    },\n\n    click: function (e) {\n      e.preventDefault();\n      this.select();\n      this.$element.focus();\n    },\n\n    mouseenter: function (e) {\n      this.mousedover = true;\n      this.$menu.find('.active').removeClass('active');\n      $(e.currentTarget).addClass('active');\n    },\n\n    mouseleave: function (e) {\n      this.mousedover = false;\n      if (!this.focused && this.shown) this.hide();\n    }\n\n  };\n\n\n  /* TYPEAHEAD PLUGIN DEFINITION\n   * =========================== */\n\n  var old = $.fn.typeahead;\n\n  $.fn.typeahead = function (option) {\n\tvar arg = arguments;\n     if (typeof option == 'string' && option == 'getActive') {\n        return this.data('active');\n     }\n    return this.each(function () {\n      var $this = $(this)\n        , data = $this.data('typeahead')\n        , options = typeof option == 'object' && option;\n      if (!data) $this.data('typeahead', (data = new Typeahead(this, options)));\n      if (typeof option == 'string') {\n        if (arg.length > 1) {\n          data[option].apply(data, Array.prototype.slice.call(arg ,1));\n        } else {\n          data[option]();\n        }\n      }\n    });\n  };\n\n  $.fn.typeahead.defaults = {\n    source: []\n  , items: 8\n  , menu: '<ul class=\"typeahead dropdown-menu\" role=\"listbox\"></ul>'\n  , item: '<li><a href=\"#\" role=\"option\"></a></li>'\n  , minLength: 1\n  , scrollHeight: 0\n  , autoSelect: true\n  , afterSelect: $.noop\n  , addItem: false\n  , delay: 0\n  };\n\n  $.fn.typeahead.Constructor = Typeahead;\n\n\n /* TYPEAHEAD NO CONFLICT\n  * =================== */\n\n  $.fn.typeahead.noConflict = function () {\n    $.fn.typeahead = old;\n    return this;\n  };\n\n\n /* TYPEAHEAD DATA-API\n  * ================== */\n\n  $(document).on('focus.typeahead.data-api', '[data-provide=\"typeahead\"]', function (e) {\n    var $this = $(this);\n    if ($this.data('typeahead')) return;\n    $this.typeahead($this.data());\n  });\n\n}));\n"],"sourceRoot":"/source/"}